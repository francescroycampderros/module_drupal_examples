id: upgrade_d7_media_images
class: Drupal\migrate\Plugin\Migration
field_plugin_method: null
cck_plugin_method: null
migration_tags:
  - 'Drupal 7'
  - Content
migration_group: migrate_drupal_7
label: 'Public files'
source:
  plugin: d7_file
  scheme: public
  constants:
    DRUPAL_FILE_DIRECTORY: 'public://'
# plugin: csv
# path: modules/custom/migrate_api_cj4/data/nodo_ejemplo4.csv
# ids: [id]
# header_offset: null
# fields:
#   - name: id
#     label: 'Image id'
#   - name: image
#     label: 'Image name'
process:
  pseudo_destination_path:
    -
      plugin: concat
      source:
        - constants/DRUPAL_FILE_DIRECTORY
        - filename        
  name: filename
  field_media_image/target_id:
    plugin: migration_lookup
    migration: upgrade_d7_file
    source: fid
  thumbnail/target_id:
    plugin: migration_lookup
    migration: upgrade_d7_file
    source: fid
destination:
  plugin: 'entity:media'
  default_bundle: image
migration_dependencies:
  required:
    - upgrade_d7_file
