id: images_to_media_example
label: 'Ejemplo de migraci√≥n 4'
migration_group: files
source: 
  constants:
    SOURCE_BASE_PATH: modules/custom/migrate_api_cj4/assets/images
    DRUPAL_FILE_DIRECTORY: 'public://'
  plugin: csv
  path: modules/custom/migrate_api_cj4/data/nodo_ejemplo4.csv
  ids: [id]
  header_offset: null
  fields:
    - name: id
      label: 'Image id'
    - name: image
      label: 'Image name'
process:
  pseudo_destination_filename:
    -
      plugin: callback
      callable: basename
      source: image
    -
      plugin: skip_on_empty
      method: row
      message: 'Cannot import empty filename.'
  pseudo_destination_path:
    -
      plugin: concat
      source:
        - constants/DRUPAL_FILE_DIRECTORY
        - '@pseudo_destination_filename'        
  name: '@pseudo_destination_filename'
  field_media_image/target_id:
    plugin: migration_lookup
    migration: nodo_ejemplo4
    source: id
  thumbnail/target_id:
    plugin: migration_lookup
    migration: nodo_ejemplo4
    source: id
destination:
  plugin: 'entity:media'
  default_bundle: image
migration_dependencies:
  required:
    - nodo_ejemplo4
